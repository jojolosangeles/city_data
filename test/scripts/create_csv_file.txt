# Load collision data into DataFrame "all_areas"
load ../data/real/Traffic_Collision_Data_from_2010_to_Present.csv as all_areas

# Display the columns (verify load)
columns all_areas

# Drop unused columns
drop all_areas DR Number, Date Reported, Area ID, Reporting District, Crime Code
drop all_areas Crime Code Description, MO Codes, Premise Code, Premise Description, Location

# Create columns for grouping
create all_areas Date [pd.to_datetime(x) for x in dataFrame['Date Occurred']]
create all_areas Weekday [x.weekday() for x in dataFrame['Date']]
create all_areas Year [x.year for x in dataFrame['Date']]
create all_areas Hour [math.floor(x/100) for x in dataFrame['Time Occurred']]

# Save DataFrame "all_areas" to CSV file "all_areas.csv"
save all_areas
